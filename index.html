<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Subir foto y CV</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f6f6f6;
      margin: 0;
      padding: 24px;
      color: #111;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 { font-size: 1.8rem; margin-bottom: 12px; }
    .card {
      max-width: 1000px;
      width: auto;
      min-width: 320px;
      display: inline-block;
      background: #fff;
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 16px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    .card-cv {
      max-width: 700px;
      width: 100%;
      margin-left: auto;
      margin-right: auto;
    }

    /* Área redonda para subir foto */
    .drop.photo {
      width: 140px;
      height: 140px;
      border-radius: 50%;
      border: 2px dashed #aaa;
      background: #fafafa;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 12px;
      cursor: pointer;
      position: relative;
      transition: border-color 0.2s;
    }
    .drop.photo.dragover {
      border-color: #2563eb;
      background: #e0f0ff;
    }
    /* Placeholder centrado y redondo */
    .placeholder {
      width: 140px;
      height: 140px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #888;
      font-size: 1rem;
      text-align: center;
      position: absolute;
      top: 0; left: 0;
      background: none;
      pointer-events: none;
      z-index: 1;
    }
    /* Imagen redonda */
    .avatar {
      width: 140px;
      height: 140px;
      border-radius: 50%;
      object-fit: cover;
      border: none;
      display: block;
      position: relative;
      z-index: 2;
      background: #fff;
    }
    .drop-cv {
      width: 100%;
      min-height: 60px;
      border: 2px dashed #aaa;
      border-radius: 12px;
      background: #fafafa;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin-bottom: 12px;
      cursor: pointer;
      position: relative;
      transition: border-color 0.2s;
      box-sizing: border-box;
    }
    .drop-cv.dragover {
      border-color: #2563eb;
      background: #e0f0ff;
    }
    #cvPlaceholder {
      color: #888;
      font-size: 1rem;
      text-align: center;
      margin: 16px 0;
      display: block;
    }
    #cvPreview {
      display: none;
      width: 100%;
      height: 400px;
      border: 1px solid #ccc;
      border-radius: 8px;
      margin-top: 12px;
      background: #fff;
    }
    input[type="file"] { display: none; }
    .btn { padding: 8px 12px; border-radius: 8px; cursor: pointer; border: 1px solid #ccc; background: #fff; }
    .btn.primary { background: #2563eb; color: #fff; border-color: #2563eb; }
    .list { list-style: none; padding: 0; margin: 0; }
    .item { display: flex; justify-content: space-between; align-items: center; padding: 6px 10px; border: 1px solid #ccc; border-radius: 8px; background: #fefefe; margin-top: 6px; }
    .msg { margin-top: 6px; font-size: 0.9rem; }
    .msg.ok { color: #16a34a; }
    .msg.err { color: #dc2626; }
  </style>
</head>
<body>
  <h1>Formulario: Foto y CV</h1>

  <div class="card">
    <h2>Foto</h2>
    <div class="drop photo" id="photoDrop">
      <div class="placeholder" id="photoPlaceholder">Previsualización<br>140×140</div>
      <img id="photoPreview" class="avatar" style="display:none;" />
      <input type="file" id="photoInput" accept="image/*" />
    </div>
    <p class="msg" id="photoMsg"></p>
    <button type="button" class="btn" id="removePhoto" disabled>Quitar foto</button>
  </div>

  <div class="card card-cv">
    <h2>CV (PDF)</h2>
    <div class="drop-cv" id="cvDrop">
      <span id="cvPlaceholder">Haz clic aquí para subir tu PDF</span>
      <input type="file" id="cvInput" accept="application/pdf" />
      <ul class="list" id="cvList"></ul>
      <iframe id="cvPreview"></iframe>
    </div>
    <button type="button" class="btn" id="removeCv" disabled>Quitar CV</button>
    <p class="msg" id="cvMsg"></p>
  </div>

  <div class="card">
    <h2>Datos</h2>
    <label>Nombre y apellido</label>
    <input type="text" id="fullname" placeholder="Ej: Ana Pérez" style="width:100%; padding:8px; border-radius:8px; border:1px solid #ccc;" />
    <label>Email</label>
    <input type="email" id="email" placeholder="ana@mail.com" style="width:100%; padding:8px; border-radius:8px; border:1px solid #ccc;" />
  </div>

  <button type="button" class="btn primary" id="submitBtn">Enviar</button>
  <p class="msg" id="formMsg"></p>

  <script>
    const photoInput = document.getElementById('photoInput');
    const photoPreview = document.getElementById('photoPreview');
    const photoPlaceholder = document.getElementById('photoPlaceholder');
    const photoMsg = document.getElementById('photoMsg');
    const removePhotoBtn = document.getElementById('removePhoto');

    const cvInput = document.getElementById('cvInput');
    const cvList = document.getElementById('cvList');
    const cvMsg = document.getElementById('cvMsg');
    const removeCvBtn = document.getElementById('removeCv');
    const cvPreview = document.getElementById('cvPreview');
    const cvPlaceholder = document.getElementById('cvPlaceholder');
    const cvDrop = document.getElementById('cvDrop');
    let cvFile = null;

    cvDrop.addEventListener('click', (e) => {
      if (e.target.id !== 'removeCv') {
        cvInput.click();
      }
    });

    cvInput.addEventListener('change', e => {
      const file = e.target.files[0];
      if (!file) return;
      cvFile = file;
      cvList.innerHTML = `<li class="item">${file.name}</li>`;
      cvMsg.textContent = 'CV cargado.';
      cvMsg.className = 'msg ok';
      removeCvBtn.disabled = false;
      // Mostrar PDF en el iframe
      const url = URL.createObjectURL(file);
      cvPreview.src = url;
      cvPreview.style.display = 'block';
      cvPlaceholder.style.display = 'none';
    });
    removeCvBtn.addEventListener('click', () => {
      cvFile = null;
      cvList.innerHTML = '';
      removeCvBtn.disabled = true;
      cvMsg.textContent = '';
      cvInput.value = '';
      cvPreview.src = '';
      cvPreview.style.display = 'none';
      cvPlaceholder.style.display = 'block';
    });

    const submitBtn = document.getElementById('submitBtn');
    const formMsg = document.getElementById('formMsg');

    let photoFile = null;

    // Foto
    photoInput.addEventListener('change', e => {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = ev => {
        photoPreview.src = ev.target.result;
        photoPreview.style.display = 'block';
        photoPlaceholder.style.display = 'none';
        photoMsg.textContent = `Foto cargada: ${file.name}`;
        photoMsg.className = 'msg ok';
        removePhotoBtn.disabled = false;
        photoFile = file;
      };
      reader.readAsDataURL(file);
    });
    removePhotoBtn.addEventListener('click', () => {
      photoFile = null;
      photoPreview.src = '';
      photoPreview.style.display = 'none';
      photoPlaceholder.style.display = 'flex';
      removePhotoBtn.disabled = true;
      photoMsg.textContent = '';
      photoInput.value = '';
    });

    // Permitir click en el área redonda para abrir el input
    document.getElementById('photoDrop').addEventListener('click', (e) => {
      // Evita que el botón "Quitar foto" dispare el input
      if (e.target.id !== 'removePhoto') {
        photoInput.click();
      }
    });

    // Enviar
    submitBtn.addEventListener('click', () => {
      formMsg.textContent = '';
      if (!photoFile) { formMsg.textContent = 'Falta la foto'; formMsg.className='msg err'; return; }
      if (!cvFile) { formMsg.textContent = 'Falta el CV'; formMsg.className='msg err'; return; }
      const fullname = document.getElementById('fullname').value.trim();
      const email = document.getElementById('email').value.trim();
      if (!fullname || !email) { formMsg.textContent='Faltan datos'; formMsg.className='msg err'; return; }
      formMsg.textContent = 'Formulario listo para enviar';
      formMsg.className='msg ok';
    });
  </script>
</body>
</html>
